<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
    <!--- basic page needs
    ================================================== -->
    <meta charset="utf-8">
    <title>Đại hội Đại biểu Hội LHTN Việt Nam Phường 7 Lần thứ V Nhiệm kỳ 2019 – 2024</title>
    <meta name="description" content="">
    <meta name="author" content="">

    <!-- mobile specific metas
    ================================================== -->
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- CSS
    ================================================== -->
    <link rel="stylesheet" href="css/base.css">
    <link rel="stylesheet" href="css/vendor.css">
    <link rel="stylesheet" href="css/main.css">

    <!-- script
    ================================================== -->
    <script src="js/modernizr.js"></script>

    <!-- favicons
    ================================================== -->
    <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
    <link rel="icon" href="favicon.ico" type="image/x-icon">
</head>

<body id="top">
    
    <!-- preloader
    ================================================== -->
    <div id="preloader">
        <div id="loader" class="dots-jump">
            <div></div>
            <div></div>
            <div></div>
        </div>
    </div>

    <!-- header
    ================================================== -->
    <header class="s-header">

        <div class="header-logo">
            <a class="site-logo" href="index.html">
                <img src="images/logo.png" alt="Homepage">
            </a>
        </div> <!-- end header-logo -->

        <nav class="header-nav">

            <a href="#0" class="header-nav__close" title="close"><span>Close</span></a>

            <h3>Navigate to</h3>

            <div class="header-nav__content">
                <ul class="header-nav__list">
                    <li><a class="smoothscroll" href="#home" title="home">Trang chủ</a></li>
                    <li><a href="khao-sat.html" title="about">Biểu Đồ Thống Kê</a></li>
                    <li><a class="smoothscroll" href="#contact" title="contact">Contact</a></li>
                </ul>
                <ul class="header-nav__social">
                    <li>
                        <a href="https://www.facebook.com/doanphuong7quan3/"><i class="fab fa-facebook"></i></a>
                    </li>
                </ul>
            </div> <!-- end header-nav__content -->

        </nav> <!-- end header-nav -->

        <a class="header-menu-toggle" href="#0">
            <span class="header-menu-icon"></span>
        </a>

    </header> <!-- end s-header -->


    <!-- home
    ================================================== -->
    <section id="home" class="s-home page-hero target-section" data-parallax="scroll" data-image-src="images/hero-bg.jpg" data-natural-width=3000 data-natural-height=2000 data-position-y=center>

        <div class="grid-overlay">
            <div></div>
        </div>

        <div class="home-content">
            <div class="row home-content__main">
                <h1> Thống kê ý kiến</h1>
                <h3 id="header_title"> Đại hội Đại biểu Hội LHTN Việt Nam Phường 7 Lần thứ V Nhiệm kỳ 2019 – 2024</h3>
                <h2> Số lượng đã biểu quyết: <span id="num_total"></span>/70</h2>
                <div class="col-six tab-full">
                    <div id="barchart_material" style="width: 1200px; height: 1200px;"></div>
                </div>
            </div>
        </div> <!-- end home-content -->

        <ul class="home-social">
            <li>
                <a href="#0"><i class="fab fa-facebook-f" aria-hidden="true"></i><span>Facebook</span></a>
            </li>
        </ul> <!-- end home-social -->
    </section> <!-- end s-home -->

    <!-- photoswipe background
    ================================================== -->
    <div aria-hidden="true" class="pswp" role="dialog" tabindex="-1">

        <div class="pswp__bg"></div>
        <div class="pswp__scroll-wrap">

            <div class="pswp__container">
                <div class="pswp__item"></div>
                <div class="pswp__item"></div>
                <div class="pswp__item"></div>
            </div>

            <div class="pswp__ui pswp__ui--hidden">
                <div class="pswp__top-bar">
                    <div class="pswp__counter"></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button> <button class="pswp__button pswp__button--share" title=
                    "Share"></button> <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button> <button class="pswp__button pswp__button--zoom" title=
                    "Zoom in/out"></button>
                    <div class="pswp__preloader">
                        <div class="pswp__preloader__icn">
                            <div class="pswp__preloader__cut">
                                <div class="pswp__preloader__donut"></div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                    <div class="pswp__share-tooltip"></div>
                </div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button> <button class="pswp__button pswp__button--arrow--right" title=
                "Next (arrow right)"></button>
                <div class="pswp__caption">
                    <div class="pswp__caption__center"></div>
                </div>
            </div>

        </div>

    </div> <!-- end photoSwipe background -->

    
    <!-- Java Script
    ================================================== -->
    <script src="js/jquery-3.2.1.min.js"></script>
    <script src="js/plugins.js"></script>
    <script src="js/main.js"></script>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <script>
        
        google.charts.load("current", {packages:['corechart']});
        google.charts.setOnLoadCallback(drawChart);
        // load1()
        function load1() {
            $.getJSON("https://sheets.googleapis.com/v4/spreadsheets/1b8EriDjfDLabmMAtM2CxEq_EcWlwujTzd_AgFZUj86M/values/Data!A1:C16?key=AIzaSyCDZ-MrZrZPxL1_ViziH4717Q2nLc2uxOs", function (response) {
                $("#num_total").html(response.values[1][1])
                $("#header_title").html(response.values[1][1])
                var data = [
                    ["Câu hỏi", "Đồng ý", "Không đồng ý"]
                ]
                response.forEach(element => {
                    data.push([element[0], parseInt(element[1]), parseInt(element[2])]);
                });
                var data = google.visualization.arrayToDataTable(data);
                var view = new google.visualization.DataView(data);
                view.setColumns([0, 1,
                    {
                        calc: "stringify",
                        sourceColumn: 1,
                        type: "string",
                        role: "annotation"
                    },
                    2]);
                var options = {
                    chart: {
                        title: 'Biểu đồ hiệp thương',
                        subtitle: 'Đại hội Đại biểu Hội LHTN Việt Nam Phường 7 Lần thứ V Nhiệm kỳ 2019 – 2024',
                    },
                    hAxis: {
                        textStyle: {
                            color: 'white',
                            fontSize: 18, // or the number you want
                        }
                    },
                    series: {
                        0: { axis: 'distance' }, // Bind series 0 to an axis named 'distance'.
                        1: { axis: 'brightness' } // Bind series 1 to an axis named 'brightness'.
                    },
                    axes: {
                        x: {
                            distance: { label: 'parsecs' }, // Bottom x-axis.
                            brightness: { side: 'top', label: 'apparent magnitude' } // Top x-axis.
                        }
                    },
                    vAxis: {
                        textStyle: {
                            color: 'white',
                            fontSize: 18, // or the number you want
                        }

                    },
                    isStacked: true,
                    backgroundColor: { fill: 'transparent' },
                    bars: 'horizontal' // Required for Material Bar Charts.
                };

                var chart = new google.charts.Bar(document.getElementById('barchart_material'));

                chart.draw(view, google.charts.Bar.convertOptions(options));
                setTimeout(function () {
                    load1();
                }, 5000);
            });
        }

        function drawChart() {
            $.ajax({
                type: "GET",
                url: "https://sheets.googleapis.com/v4/spreadsheets/1b8EriDjfDLabmMAtM2CxEq_EcWlwujTzd_AgFZUj86M/values/Data!A1:C28?key=AIzaSyCDZ-MrZrZPxL1_ViziH4717Q2nLc2uxOs",
                dataType: "json",
                success: function (response) {
                    $("#num_total").html(response.values[0][1])
                    var title2 = response.values[0][0];
                    $("#header_title").html(title2)
                    
                    var temp = response.values;
                    temp.shift();
                    var data = [
                        ["Câu hỏi", "Đồng ý", "Không đồng ý"]
                    ]
                    temp.forEach(element => {
                        if (element[0] != "") data.push([element[0], parseInt(element[1]), parseInt(element[2])]);
                    });                 
                    var data = google.visualization.arrayToDataTable(data);
                    var view = new google.visualization.DataView(data);
                    view.setColumns([0, 1,
                        {
                            calc: "stringify",
                            sourceColumn: 1,
                            type: "string",
                            role: "annotation"
                        },
                        2]);
                    var options = {
                        chart: {
                            title: 'Biểu đồ hiệp thương',
                            subtitle: title2,
                        }, 
                        legend: {
                            position: 'top',
                            alignment: 'start'
                        },
                        hAxis: {
                            textStyle: {
                                color: 'white',
                                fontSize: 18, // or the number you want
                            }

                        },
                        vAxis: {
                            textStyle: {
                                color: 'white',
                                fontSize: 18, // or the number you want
                            }
                        },
                        isStacked: true,
                        backgroundColor: { fill: 'transparent' },
                        bars: 'horizontal' // Required for Material Bar Charts.
                    };
                    var chart = new google.visualization.ColumnChart(document.getElementById("barchart_material"));
                    chart.draw(view, options);
                }
            });
            
        }
    </script>
</body>
